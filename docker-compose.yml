version: '3.8'

services:
  ppvo:
    build:
      context: .
      dockerfile: Dockerfile
    image: ppvo:latest
    container_name: ppvo
    volumes:
      # Mount your TUM dataset directory
      - ./data:/data
      # Mount output directory
      - ./outputs:/outputs
      # Optional: mount config files for easy editing
      - ./src/ppvo/configs:/app/src/ppvo/configs
    environment:
      - PYTHONUNBUFFERED=1
      - NVIDIA_VISIBLE_DEVICES=all
      - NVIDIA_DRIVER_CAPABILITIES=compute,utility
      - CUDA_HOME=/usr/local/cuda
    # Override the default command to run with your dataset
    # Example command (modify paths as needed):
    command: >
      python src/ppvo/scripts/run_tum.py --tum_dir /data/rgbd_dataset_freiburg1_xyz --config src/ppvo/configs/default.yaml --out_dir /outputs
    # For GUI/visualization support (optional)
    # Uncomment the following lines if you need visualization:
    # environment:
    #   - DISPLAY=${DISPLAY}
    # volumes:
    #   - /tmp/.X11-unix:/tmp/.X11-unix:rw
    # network_mode: host
